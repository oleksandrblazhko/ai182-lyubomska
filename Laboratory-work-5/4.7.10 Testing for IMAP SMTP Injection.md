### Тестування для впровадження XPath

| ID |
|----|
|WSTG-INPV-09|


### Резюме
</br>XPath — це мова, яка була розроблена та розроблена переважно для адресації частин документа XML. Під час ін’єкційного тестування XPath ми перевіряємо, чи можливо вставити синтаксис XPath у запит, інтерпретований програмою, дозволяючи зловмиснику виконувати керовані користувачем запити XPath. У разі успішного використання ця вразливість може дозволити зловмиснику обійти механізми автентифікації або отримати доступ до інформації без належного авторизації.

</br>Веб-програми активно використовують бази даних для зберігання та доступу до даних, необхідних для їх роботи. Історично реляційні бази даних були найпоширенішою технологією зберігання даних, але в останні роки ми спостерігаємо зростаючу популярність баз даних, які організовують дані за допомогою мови XML. Подібно до того, як доступ до реляційних баз даних здійснюється через мову SQL, бази даних XML використовують XPath як стандартну мову запитів.

</br>Оскільки з концептуальної точки зору XPath дуже схожий на SQL за своїм призначенням і застосуванням, цікавим результатом є те, що атаки ін’єкції XPath слідують тій же логіці, що й атаки ін’єкції SQL . У деяких аспектах XPath є навіть потужнішим, ніж стандартний SQL, оскільки вся його потужність уже присутня в його специфікаціях, тоді як велика кількість технік, які можна використовувати в атаці SQL Injection, залежить від характеристик діалекту SQL, який використовує цільова база даних. Це означає, що ін’єкційні атаки XPath можуть бути набагато більш адаптивними та повсюдними. Ще одна перевага ін’єкційної атаки XPath полягає в тому, що, на відміну від SQL, ACL не застосовуються, оскільки наш запит може отримати доступ до кожної частини XML-документа.

### Цілі тесту
Визначте точки впровадження XPATH.

### Як тестувати
Шаблон атаки XPath був вперше опублікований Амітом Кляйном і дуже схожий на звичайне впровадження SQL. Щоб отримати перше розуміння проблеми, давайте уявімо сторінку входу, яка керує автентифікацією в програмі, у якій користувач повинен ввести своє ім’я користувача та пароль.
Як і у звичайній атаці SQL-ін’єкції, ми створили запит, який завжди оцінюється як істинний, що означає, що програма автентифікує користувача, навіть якщо ім’я користувача чи пароль не було надано. І як у звичайній атаці SQL-ін’єкції, з ін’єкцією XPath першим кроком є ​​вставлення одиночної лапки ( ') у поле, яке потрібно перевірити, вводячи синтаксичну помилку в запит, і перевірити, чи програма повертає повідомлення про помилку.

Якщо немає інформації про внутрішні деталі XML-даних і якщо програма не надає корисних повідомлень про помилки, які допомагають нам реконструювати її внутрішню логіку, можна здійснити сліпу атаку XPath Injection , метою якої є реконструкція всієї структури даних. Техніка подібна до SQL-ін’єкції на основі висновків, оскільки підхід полягає у впровадженні коду, який створює запит, який повертає один біт інформації. Сліпу ін’єкцію XPath більш детально пояснює Аміт Кляйн у статті, на яку посилається.
